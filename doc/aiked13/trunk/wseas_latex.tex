\renewcommand*\newunitpunct{\addcomma\addspace}
\DeclareFieldFormat[inproceedings]{booktitle}{}
\DeclareFieldFormat{volume}{}
\DeclareFieldFormat[inproceedings]{title}{#1}
\DeclareFieldFormat[book]{title}{#1}
\DeclareFieldFormat[article]{title}{#1}
\DeclareFieldFormat[incollection]{title}{#1}
\DeclareFieldFormat[collection]{title}{#1}
\DeclareFieldFormat[online]{title}{#1}

\DeclareFieldFormat{series}{\em #1}
\DeclareFieldFormat{pages}{\small pp#1}

\renewbibmacro*{title}{%
  \printfield{title}
}

\renewbibmacro*{publisher+location+date}{%
  \printlist{publisher}%
  \newunit
  \printfield{year}%
  \newunit
}

\renewbibmacro*{issue+date}{%
  \newunit
  \printfield{year}
}

\renewbibmacro*{in:}{
}

\newbibmacro*{in:collection}{
  \printtext{%
    \bibstring{in} \cite{\thefield{crossref}}}
%  \newunit
%  \cite{\thefield{crossref}}
}

%http://www.tex.ac.uk/tex-archive/macros/latex/contrib/biblatex/latex/

\DeclareBibliographyDriver{incollection}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/translator+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
%  \usebibmacro{in:}%
  \usebibmacro{in:collection}%
%  \usebibmacro{maintitle+booktitle}%
%  \newunit\newblock
%  \usebibmacro{byeditor+others}%
%  \newunit\newblock
%  \printfield{edition}%
%  \newunit
%  \iffieldundef{maintitle}
%    {\printfield{volume}%
%     \printfield{part}}
%    {}%
%  \newunit
%  \printfield{volumes}%
%  \newunit\newblock
%  \usebibmacro{series+number}%
%  \newunit\newblock
%  \printfield{note}%
%  \newunit\newblock
%  \usebibmacro{publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
%  \newunit\newblock
%  \iftoggle{bbx:isbn}
%    {\printfield{isbn}}
%    {}%
%  \newunit\newblock
%  \usebibmacro{doi+eprint+url}%
%  \newunit\newblock
%  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \newunit\newblock
%  \usebibmacro{related}%
  \usebibmacro{finentry}}


%a cada secció hi ha un vspace

\makeatletter

\let\old@section\section

\renewcommand*{\section}{%
  \@ifstar{%
    \starsection
  }{%
    \@dblarg\nostarsection
  }%
}
\newcommand*{\starsection}[1]{%
  \vspace{-12pt}
  \old@section*{#1}%
  \vspace{-10pt}%
}
\newcommand{\nostarsection}{}
\def\nostarsection[#1]#2{%
  % #1: toc entry
  % #2: main entry
  \vspace{-9pt}
  \old@section[{#1}]{#2}%
  \vspace{-10pt}%
}

\let\old@subsection\subsection
\renewcommand\subsection[2][]{\vspace{-11pt}\old@subsection[#1]{#2}\vspace{-9pt}}

\makeatother

%reals
\makeatletter
%\let\old@mathbb\mathbb
%\renewcommand\mathbb[2][]{{\rm I}\!{\rm #2}}
\makeatother

% redimensió de les llistes
\usepackage{enumitem}
\setitemize{topsep=1pt,itemsep=1pt,leftmargin=8pt,labelwidth=6pt}


%espai figures
\setlength{\floatsep}{4ex}
%\setlength{\dblfloatsep}{0cm}
%\setlength{\dbltextfloatsep}{0cm}
\setlength{\abovecaptionskip}{0cm}
\setlength{\belowcaptionskip}{-3ex}

\usepackage{caption}
\captionsetup{font=small,labelfont=small}