\subsection*{Exemple multiresolució}


\begin{frame}{Exemple multiresolució: sèrie temporal original}

\begin{center}
\scriptsize
\input{imatges/exemple/isense_original.tex}
\end{center}

\end{frame}

\begin{frame}{Exemple multiresolució: esquema de multiresolució}


\begin{center}
\input{imatges/exemple/mtsdb-time_window.tex}
\end{center}

\end{frame}

\begin{frame}{Exemple multiresolució: subsèries emmagatzemades}


\begin{center}
\scriptsize
\input{imatges/exemple/isense_4mrdb.tex}
\end{center}

\end{frame}

\begin{frame}{Exemple multiresolució: comparació}

\begin{center}
\scriptsize
\input{imatges/exemple/isense_mrdb-all.tex}
\end{center}

\end{frame}


\subsection[SGSTM]{Sistemes de gestió de sèries temporals multiresolució (SGSTM)}

\begin{frame}{SGSTM - Estructura}
\begin{columns}
  
  \column{4cm}
  Conceptes:
  \begin{itemize}

  \item Buffer
  \item Disc
  \item Subsèrie resolució
  \item Sèrie temporal multiresolució
  \item Esquema de multiresolució: Conjunt de resolucions (pas, temps d'inici, cardinal, funció d'agregació)

  \end{itemize}

  \column{6cm}


\begin{tikzpicture}[scale=0.7, every node/.style={transform shape}]
 \tikzset{
        myarrow/.style={->, >=latex',  thick},
      }
      

  \node[rectangle,draw,minimum height=6cm,minimum width=9cm] (m) {};
  \draw[shift=( m.south west)]   
  node[above right] {sèrie temporal multiresolució};


  %discmig
  \node (m.center) (discr1) {...};

  %discr
  
  \node[ellipse,draw,minimum height=3.5cm,minimum width=2.5cm,alias=discr0] [left=of discr1] {};
  \node[above=0cm of discr0.north] {$R_0$};
  \node[below=0cm of discr0] {subsèrie resolució};

  \node[cylinder, draw, shape border rotate=90, aspect=0.25,alias=buffer0] [below=3mm of discr0.north] {buffer};
  \node[circle, draw,alias=disc0]  [above=3mm of discr0.south] {disc} ;
  \draw [->] (disc0.center)++(.4:.4cm) arc(0:180:.4cm);
  \draw[myarrow] (buffer0.bottom) -- (disc0.north);


  %discrd

  \node[ellipse,draw,minimum height=3.5cm,minimum width=2.5cm,alias=discrd] [right=of discr1] {};
  \node[above=0cm of discrd] {$R_d$};
  \node[below=0cm of discrd] {subsèrie resolució};

  \node[cylinder, draw, shape border rotate=90, aspect=0.25,alias=bufferd] [below=3mm of discrd.north] {buffer};
  \node[circle, draw,alias=discd]  [above=3mm of discrd.south] {disc} ;
  \draw [->] (discd.center)++(.4:.4cm) arc(0:180:.4cm);
  \draw[myarrow] (bufferd.bottom) -- (discd.north);



  %mesura 
  \node[above=1cm of m.north] (m0) {Sèrie temporal};

  \draw[myarrow] (m0) -- (m.north) 
  node[right,midway] {mesura};

  \draw[myarrow] (m.north) -- (buffer0);
  \draw[myarrow] (m.north) -- (bufferd);
  \draw[myarrow] (m.north) -- (discr1);

\end{tikzpicture}


\end{columns}
\end{frame}




\begin{frame}{SGSTM - Operacions}

  \begin{itemize}
  \item Estructurals: 
    \begin{itemize}
    \item afegir mesura als buffers 
    \item consolidar les resolucions: agregar buffer i afegir al disc
    \end{itemize}

  \item Manipulació de l'esquema
    \begin{itemize}
    \item cronogrames, canvis, junció\dots
    \end{itemize}

  \item Consultes
    \begin{itemize}
    \item extracció de subsèries temporals dels discs
    \item sèrie temporal total: màxima resolució
    \end{itemize}

  \end{itemize}


\begin{block}{Sèrie temporal total}
Concatenació de les subsèries temporals ordenades per pas de consolidació de les resolucions $\delta_0 < \dotsb < \delta_k$:  $\text{SerieTotal}(M)= S_{0} || \dotsb || S_{k}$
\end{block}

\end{frame}



\begin{frame}{Exemples de consultes}

Les consultes de multiresolució obtenen sèries temporals:

\begin{itemize}
\item Obtenció de la resolució més propera a la demandada
\item Operacions de SGST per a una sèrie temporal: $\max(S)$
\item Operacions de SGST per a dues sèries temporals:  $S_1 \cup S_2$, $S_1 + S_2$\dots
\end{itemize}

Les operacions computacionals de dues sèries temporals impliquen junció:

\begin{itemize}
\item Si són regulars amb els mateixos temps: junció conjunts
\item Si no són regulars: junció temporal
\end{itemize}


\end{frame}



\begin{frame}{SGSTM - Funcions d'agregació d'atributs}

\begin{centering}

 mesura = funció(sèrie temporal $S$, instant d'inici $\tau$, pas $\delta$)


   \begin{tikzpicture}[scale=0.7, every node/.style={transform shape}]
    \begin{axis}[
        ymin = 0,
        yticklabels= {,,,,valors},
        y tick label style = {rotate=90,anchor=south},
        xticklabels={,,$\underbrace{t_0 \vphantom{\delta}}_{\tau^0}$,,$\underbrace{\tau_0+\delta}_{\tau_1}$,,$\underbrace{\tau_1+\delta}_{\tau_2}$,,$\underbrace{\tau_2+\delta}_{\tau_3 \ldots}$},
        ]
 
    \addplot[ycomb,blue] coordinates {
        (20,10)
        (30,10)
        (40,10)
        (50,10)
    }; 

    \addplot[red,only marks, mark = *] coordinates {
        (19,4)
        (22,6)
        (25,7)
        (29,8)
        (35,2)
        (41,5)
        (45,8)
    };

          \addplot[only marks,mark=*,green] coordinates {
            (30,7)
            (40,3)
            (50,6)
          };

          \node[right] at (axis cs:30,7) {$m_1$};
          \node[right] at (axis cs:40,3) {$m_2$};
          \node[above] at (axis cs:50,6) {$m_3$};
    \end{axis}
  \end{tikzpicture}

\end{centering}


Diferents atributs d'agregació en diferents mètodes de representació

\begin{example}[Funció d'agregació màxim ZOHE] 
 $\text{màximZOHE}(S,\tau,\delta)=(\tau+\delta,v)$ on
    $v = \max_{\forall m' \in S[\tau,\tau+\delta]^{\text{zohe}}}(V(m'))$
 
\end{example}




\end{frame}



\begin{frame}{SGSTM - Consolidació}


\begin{columns}
\column{6cm}
  \begin{tikzpicture}[scale=0.7, every node/.style={transform shape}]
    \begin{axis}[
        ymin = 0,
        yticklabels= {,,,,valors},
        y tick label style = {rotate=90,anchor=south},
        xticklabels={,,$\tau$,,$\tau+\delta$,,,,},
        ]
 
    \addplot[ycomb,blue] coordinates {
        (20,10)
        (30,10)
    };
    \addplot[ycomb,gray] coordinates {
        (40,10)
        (50,10)
    }; 

    \addplot[red,only marks, mark = *] coordinates {
        (22,6)
        (25,7)
        (29,8)
    };
    \addplot[gray,only marks, mark = *] coordinates {
        (19,4)
        (35,2)
        (41,5)
        (45,8)
    };



          \addplot[only marks,mark=*,gray] coordinates {
            (30,7)
            (40,3)
            (50,6)
          };


          \node[right, gray] at (axis cs:30,7) {$m_1$};
           \node[right, gray] at (axis cs:40,3) {$m_2$};
           \node[above, gray] at (axis cs:50,6) {$m_3$};

          \node[above] at (axis cs:22,6) {$a$};
          \node[above] at (axis cs:25,7) {$b$};
          \node[above] at (axis cs:29,8) {$c$};

    \end{axis}
  \end{tikzpicture}


\column{5cm}

$\text{Buffer}=(\{a,b,c\},\tau,\delta,f)$

$\text{Disc}=(\{\},\kappa)$


\end{columns}


  Consolidació de la sèrie temporal en els buffers
  incrementalment:

  \begin{enumerate}
  
    \item Afegeix mesures del primer interval $[\tau,\tau+\delta]$:

    \item Calcula la mesura resultant $m_1=f(\{a,b,c\},\tau,\delta)$


  \end{enumerate}


\end{frame}



\begin{frame}{SGSTM - Consolidació}



\begin{columns}
\column{6cm}
  \begin{tikzpicture}[scale=0.7, every node/.style={transform shape}]
    \begin{axis}[
        ymin = 0,
        yticklabels= {,,,,valors},
        y tick label style = {rotate=90,anchor=south},
        xticklabels={,,$\tau$,,$\tau+\delta$,,,,},
        ]
 
    \addplot[ycomb,blue] coordinates {
        (20,10)
        (30,10)
    };
    \addplot[ycomb,gray] coordinates {
        (40,10)
        (50,10)
    }; 

    \addplot[black,only marks, mark = *] coordinates {
        (22,6)
        (25,7)
        (29,8)
    };
    \addplot[gray,only marks, mark = *] coordinates {
        (19,4)
        (35,2)
        (41,5)
        (45,8)
    };


          \addplot[only marks,mark=*,green] coordinates {
            (30,7)
          };
          \addplot[only marks,mark=*,gray] coordinates {
            (40,3)
            (50,6)
          };


          \node[right] at (axis cs:30,7) {$m_1$};
           \node[right, gray] at (axis cs:40,3) {$m_2$};
           \node[above, gray] at (axis cs:50,6) {$m_3$};

          \node[above] at (axis cs:22,6) {$a$};
          \node[above] at (axis cs:25,7) {$b$};
          \node[above] at (axis cs:29,8) {$c$};

    \end{axis}
  \end{tikzpicture}


\column{5cm}

$\text{Buffer}=(\{\},\tau+\delta,\delta,f)$

$\text{Disc}=(\{m_1\},\kappa)$
\end{columns}

\vphantom{Consolidació:}
  \begin{enumerate}
      \setcounter{enumi}{2}

\item Canvia l'instant de consolidació i descarta les mesures consolidades

\item Afegeix la mesura consolidada al disc

\end{enumerate}


\end{frame}



\begin{frame}{SGSTM - Consolidació}



\begin{columns}
\column{6cm}
  \begin{tikzpicture}[scale=0.7, every node/.style={transform shape}]
    \begin{axis}[
        ymin = 0,
        yticklabels= {,,,,valors},
        y tick label style = {rotate=90,anchor=south},
        xticklabels={,,,,$\tau$,,$\tau+\delta$,,},
        ]
 
    \addplot[ycomb,blue] coordinates {
        (30,10)
        (40,10)
    };
    \addplot[ycomb,gray] coordinates {
        (20,10)
        (50,10)
    }; 

    \addplot[red,only marks, mark = *] coordinates {
        (35,2)
    };
    \addplot[gray,only marks, mark = *] coordinates {
        (19,4)
        (22,6)
        (25,7)
        (29,8)
        (41,5)
        (45,8)
    };

          \addplot[only marks,mark=*,green] coordinates {
            (30,7)
          };
          \addplot[only marks,mark=*,gray] coordinates {
            (40,3)
            (50,6)
          };


          \node[right] at (axis cs:30,7) {$m_1$};
           \node[right, gray] at (axis cs:40,3) {$m_2$};
           \node[above, gray] at (axis cs:50,6) {$m_3$};

          \node[above] at (axis cs:35,2) {$d$};

    \end{axis}
  \end{tikzpicture}


\column{5cm}

$\text{Buffer}=(\{d\},\tau,\delta,f)$

$\text{Disc}=(\{m_1\},\kappa)$


\end{columns}


\vphantom{Consolidació:}

  \begin{enumerate}
      \setcounter{enumi}{4}
\item Afegeix les noves mesures al buffer

\item Torna a començar la consolidació (controlant el cardinal del disc)

\end{enumerate}



\end{frame}



%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "defensa"
%%% End: 
%  LocalWords:  multiresolució SGSTM Buffer buffer buffers subsèries
%  LocalWords:  SGST
